# **************************************************************************** #
#                                                                              #
#                                                         :::      ::::::::    #
#    Makefile                                           :+:      :+:    :+:    #
#                                                     +:+ +:+         +:+      #
#    By: mcha <mcha@student.42.fr>                  +#+  +:+       +#+         #
#                                                 +#+#+#+#+#+   +#+            #
#    Created: 2022/06/03 14:16:54 by mcha              #+#    #+#              #
#    Updated: 2022/06/03 16:12:00 by mcha             ###   ########.fr        #
#                                                                              #
# **************************************************************************** #

##########################################################################
##																		##
##								Basic									##
##																		##
##########################################################################
CC			= gcc
CFLAGS		= -I $(HEAD_ROOT) -Wall -Werror -Wextra


##########################################################################
##																		##
##								Dependency								##
##																		##
##########################################################################
NAME		= cub3D
LIBFT		= libft/libft.a
RM			= rm -rf


##########################################################################
##																		##
##							Root Directory								##
##																		##
##########################################################################
OBJS_ROOT	= obj
SRCS_ROOT	= src
LIBF_ROOT	= libft
HEAD_ROOT	= include


##########################################################################
##																		##
##							Source Directory							##
##					* Add Directory path at vpath						##
##########################################################################
SRCS_MAIN	= src/main

vpath %.c	$(SRCS_ROOT) \
			$(SRCS_MAIN)

# Add source subdirectory
# SRCS_ROOT 	:= $(SRCS_MAIN)


##########################################################################
##																		##
##								Source File								##
##																		##
##########################################################################
FILE_MAIN	= $(notdir $(wildcard $(SRCS_MAIN)/*.c))


##########################################################################
##																		##
##								Object File								##
##																		##
##########################################################################
OBJ_MAIN	= $(FILE_MAIN:.c=.o)


##########################################################################
##																		##
##							Integrated bject File						##
##																		##
##########################################################################
OBJ 		:= $(OBJ_MAIN)
OBJ 		:= $(addprefix $(OBJS_ROOT)/, $(OBJ))


$(OBJS_ROOT)/%.o : %.c
	@echo "[~] Linking $<"
	@$(CC) $(CFLAGS) -c -o $@ $<

$(NAME) : $(OBJ)
	@echo "[+] Create libft"
	@make -s -C $(LIBF_ROOT)
	@echo "[+] Create cub3D"
	@$(CC) $(CFLAGS) -o $@ $(OBJ) $(LIBFT)


##########################################################################
##																		##
##								  Commands								##
##																		##
##########################################################################
all : $(NAME)

clean :
	@$(RM) $(OBJ)
	@echo "[-] Delete object files"

fclean : clean
	@echo "[-] Delete run files"
	@$(RM) $(NAME)
	@echo "[-] Delete libft"
	@make fclean -s -C $(LIBF_ROOT)

re : 
	make fclean
	make all

.PHONY : all clean fclean re